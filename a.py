import pymysql
import sys
import os

def insert(sig,isMalware):
	# Open database connection
	db = pymysql.connect("localhost","mayank","mayank@25","Majorproject" )

	# prepare a cursor object using cursor() method
	cursor = db.cursor()

	# execute SQL query using execute() method.
	sql = "INSERT INTO MalwareSignatures(Sno, md5, isMalware) VALUES ('%d',%s','%s')" % (2,sig,isMalware)
	try:
   		# Execute the SQL command
   		cursor.execute(sql)
   		# Commit your changes in the database
   		db.commit()
	except:
   		# Rollback in case there is any error
   		db.rollback()
	# disconnect from server
	db.close()


def check(sig):
	# Open database connection
	db = pymysql.connect("localhost","mayank","mayank@25","Majorproject" )

	# prepare a cursor object using cursor() method
	cursor = db.cursor()

	# Prepare SQL query to INSERT a record into the database.
	sql = "SELECT isMalware FROM MalwareSignatures  WHERE md5 = '%s'" % (sig)
	try:
   		# Execute the SQL command
   		cursor.execute(sql)
   		# Fetch all the rows in a list of lists.
   		results = cursor.fetchall()
   		for row in results:
   			f = row[0]
   		# Now print fetched result
   		print ("IsMalware = %s" % (f))
	except:
   		print ("Error: unable to fetch data")

	# disconnect from server
	db.close()
#insert("7dd2551d72670117b7ca90470a533cd9","False")
#insert("c0685ba570ef7d0371f76c11b6176c3c","True")
#md5 = str(os.system("cat " + sys.argv[1] +"|md5"))
#print(type(md5))
check(sys.argv[1])



